<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
    <head th:replace="~{fragments/head :: head}"></head>

    <body>
        <div th:replace="~{fragments/navbar :: navbar}"></div>
        <div th:replace="~{fragments/sidebar :: sidebar}"></div>

        <div class="main-content">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="text-danger">
                    <i class="bi bi-terminal-fill me-2"></i> SQL Console
                </h2>
                <a th:href="@{/super-admin}" class="btn btn-outline-secondary"
                    >Back to Dashboard</a
                >
            </div>

            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <form th:action="@{/super-admin/sql/execute}" method="post">
                        <div class="mb-3">
                            <label class="form-label fw-bold">SQL Query</label>
                            <textarea
                                name="query"
                                class="form-control font-monospace bg-light"
                                rows="5"
                                placeholder="SELECT * FROM users;"
                                th:text="${lastQuery}"
                                required
                            ></textarea>
                        </div>
                        <div class="d-flex justify-content-between">
                            <small class="text-muted"
                                >Supported: SELECT, UPDATE, DELETE,
                                INSERT</small
                            >
                            <button type="submit" class="btn btn-danger">
                                <i class="bi bi-play-fill"></i> Execute
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div th:if="${error}" class="alert alert-danger">
                <i class="bi bi-x-circle me-2"></i>
                <span th:text="${error}"></span>
            </div>

            <div th:if="${success}" class="alert alert-success">
                <i class="bi bi-check-circle me-2"></i>
                <span th:text="${success}"></span>
            </div>

            <div th:if="${results}" class="card shadow-sm">
                <div class="card-header bg-dark text-white small">
                    Query Results
                </div>
                <div class="table-responsive">
                    <table
                        class="table table-striped table-hover table-sm mb-0 font-monospace"
                    >
                        <thead class="table-secondary">
                            <tr>
                                <th th:each="col : ${columns}" th:text="${col}">
                                    Column
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            <tr th:each="row : ${results}">
                                <td
                                    th:each="entry : ${row.entrySet()}"
                                    th:text="${entry.value}"
                                ></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script th:src="@{/js/app.js}"></script>
    </body>
</html>
